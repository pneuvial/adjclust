<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="S3 class for Constrained Hierarchical Agglomerative Clustering results"><title>Class chac — chac • adjclust</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Class chac — chac"><meta property="og:description" content="S3 class for Constrained Hierarchical Agglomerative Clustering results"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">adjclust</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hicClust.html">Clustering of Hi-C contact maps</a>
    <a class="dropdown-item" href="../articles/notesCHAC.html">Implementation notes for the `adjclust` package</a>
    <a class="dropdown-item" href="../articles/snpClust.html">Inferring Linkage Disequilibrium blocks from genotypes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pneuvial/adjclust/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Class chac</h1>
      <small class="dont-index">Source: <a href="https://github.com/pneuvial/adjclust/blob/HEAD/R/chac.R" class="external-link"><code>R/chac.R</code></a></small>
      <div class="d-none name"><code>chac.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>S3 class for Constrained Hierarchical Agglomerative Clustering results</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for chac</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/as.hclust.html" class="external-link">as.hclust</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for chac</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for chac</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for chac</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for chac</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"corrected"</span>, <span class="st">"total-disp"</span>, <span class="st">"within-disp"</span>, <span class="st">"average-disp"</span><span class="op">)</span>,</span>
<span>  nodeLabel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">diagnose</span><span class="op">(</span><span class="va">x</span>, graph <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">correct</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cutree_chac</span><span class="op">(</span><span class="va">tree</span>, k <span class="op">=</span> <span class="cn">NULL</span>, h <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x, object, tree</dt>
<dd><p>an object of class 'chac'</p></dd>


<dt>...</dt>
<dd><p>for <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>, arguments passed to the function 
<code><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">plot.dendrogram</a></code>. Default values for <code>type</code> and
<code>leaflab</code> are respectively set to <code>"triangle"</code> and <code>"none"</code></p></dd>


<dt>y</dt>
<dd><p>not used</p></dd>


<dt>mode</dt>
<dd><p>type of dendrogram to plot (see Details). Default to 
<code>"standard"</code></p></dd>


<dt>nodeLabel</dt>
<dd><p>(logical) whether the order of merging has to be displayed
or not. <code>nodeLabel=TRUE</code> prints orders of fusion at corresponding
nodes. Default to <code>FALSE</code></p></dd>


<dt>graph</dt>
<dd><p>(logical) whether the diagnostic plot has to be displayed or 
not. Default to <code>TRUE</code></p></dd>


<dt>verbose</dt>
<dd><p>(logical) whether to print a summary of the result or not.
Default to <code>TRUE</code></p></dd>


<dt>k</dt>
<dd><p>an integer scalar or vector with the desired number of groups</p></dd>


<dt>h</dt>
<dd><p>numeric scalar or vector with heights where the tree should be cut.
Only available when the heights are increasing</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function <code>plot.chac</code> displays the dendrogram and 
additionally invisibly returns an object of class 
<code><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">dendrogram</a></code> with heights as specified by the user through
the option <code>mode</code>.</p>


<p><code>diagnose</code> invisibly exports a data frame with the 
numbers of decreasing merges described by the labels of the clusters being
merged at this step and at the previous one, as well as the corresponding
merge heights.</p>


<p>The function <code>correct</code> returns a <code>chac</code> objects with
modified heights so as they are increasing. The new heights are calculated in
an way identical to the option <code>mode = "corrected"</code> of the function
<code>plot.chac</code> (see Details). In addition, the <code>chac</code> object has its
field <code>method</code> modified from <code>adjClust</code> to 
<code>adjClust-modified</code>.</p>


<p>The function <code>cutree_chac</code> returns the clustering with 
<code>k</code> groups or with the groups obtained by cutting the tree at height
<code>h</code>. If the heights are not increasing, the cutting of the tree is based
on the corrected heights as provided by the function <code>correct</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Methods for class 'chac'</p>
<p>When <code>plot.chac</code> is called with 
<code>mode = "standard"</code>, the standard dendrogram is plotted, even though,
due to contingency constrains, some branches are reversed (decreasing
merges). When <code>plot.chac</code> is called with 
<code>mode = "corrected"</code>, a correction is applied to original heights so as
to have only non decreasing merges). It does not change the result of the 
clustering, only the look of the dendrogram for easier interpretation.<br><br>
Other modes are provided that correspond to different alternatives
described in Grimm (1987):</p><ul><li><p>in <code>mode = "within-disp"</code>, heights correspond to within-cluster
dispersion, <em>i.e.</em>, for a corresponding cluster, its height is 
$$I(C) = \sum_{i \in C} d(i,g_C)$$ where \(d\) is the dissimilarity 
used to cluster objects and \(g_C\) is the center of gravity of cluster
\(C\). In this case, heights are always non decreasing;</p></li>
<li><p>in <code>mode = "total-disp"</code>, heights correspond to the total
within-cluster dispersion. It is obtained from <code>mode = "standard"</code> by
the cumulative sum of its heights. In this case, heights are always
non decreasing;</p></li>
<li><p>in <code>mode = "average-disp"</code>, heights correspond to the 
within-cluster dispersion divided by the cluster size. In this case, there 
is no guaranty that the heights are non decreasing. When reversals are 
detected, a warning is printed to advice the user to change the mode of the
representation.</p></li>
</ul><p>Grimm (1987) indicates that heights as provided by 
<code>mode = "within-disp"</code> are highly dependent on cluster sizes and that 
the most advisable representation is the one provided by 
<code>mode = "total-disp"</code>. Further details are provided in the vignette 
"Notes on CHAC implementation in adjclust".</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Grimm, E.C. (1987) CONISS: a fortran 77 program for
stratigraphically constrained analysis by the method of incremental sum of
squares. <em>Computer &amp; Geosciences</em>, <strong>13</strong>(1), 13-35.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://www.math-evry.cnrs.fr/members/cambroise/" class="external-link">Christophe Ambroise</a>, Shubham Chaturvedi, Alia Dehman, <a href="https://www.math.univ-toulouse.fr/~pneuvial/" class="external-link">Pierre Neuvial</a>, Guillem Rigaill, <a href="http://www.nathalievialaneix.eu" class="external-link">Nathalie Vialaneix</a>, Gabriel Hoffman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

