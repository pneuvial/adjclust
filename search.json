[{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Clustering of Hi-C contact maps","text":"Hi-C sequencing-based molecular assay designed measure intra inter-chromosomal interactions DNA molecule. particular, identification Topologically-Associated Domains (TADs), , regions genome physical interactions frequent, provides insight three-dimensional organization genome [2]. Hi-C data form two-dimensional contact maps, .e., matrices whose \\(,j\\) entry quantifies intensity physical interaction two genome regions \\(\\) \\(j\\) DNA level. vignette, demonstrate use adjclust::hicClust perform adjacency-constrained hierarchical agglomerative clustering (HAC) Hi-C contact maps. output function dendrogram, can cut identify TADs. algorithm used adjacency-constrained (HAC) described [3,4].","code":"library(\"adjclust\")"},{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"loading-and-displaying-a-sample-hi-c-contact-map","dir":"Articles","previous_headings":"","what":"Loading and displaying a sample Hi-C contact map","title":"Clustering of Hi-C contact maps","text":"data set hic_imr90_40_XX object class HTCexp obtained HiTC package [4]. contact map corresponding first 500 x 500 bins chromosome X vs chromosome X. script used create map can found executing following command: Now look data.","code":"load(system.file(\"extdata\", \"hic_imr90_40_XX.rda\", package = \"adjclust\")) system.file(\"system/create_hic_chrXchrX.R\", package=\"adjclust\") ## [1] \"/home/runner/work/_temp/Library/adjclust/system/create_hic_chrXchrX.R\" HiTC::mapC(hic_imr90_40_XX)"},{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"using-hicclust","dir":"Articles","previous_headings":"","what":"Using hicClust","title":"Clustering of Hi-C contact maps","text":"hicClust operates directly objects class HTCexp also possible work binned data. choose bin size \\(5 \\times 10^5\\):  output class chac. particular, can plotted dendrogram silently relying function plot.dendrogram:  Moreover, output contains element named merge describes successive merges clustering, element gains gives improvement criterion optimized clustering successive merge.","code":"fit <- hicClust(hic_imr90_40_XX) binned <- HiTC::binningC(hic_imr90_40_XX, binsize = 1e5) fitB <- hicClust(binned) fitB ##  ## Call: ## hicClust(binned) ##  ## Cluster method   : hicClust  ## Number of objects: 205 HiTC::mapC(binned) plot(fitB, mode = \"corrected\") head(cbind(fitB$merge, fitB$gains)) ##      [,1] [,2] ## [1,]   -3   -4 ## [2,]   -2    1 ## [3,]    2   -5 ## [4,]   -1    3 ## [5,]    4   -6 ## [6,]  -17  -18"},{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"other-types-of-input","dir":"Articles","previous_headings":"","what":"Other types of input","title":"Clustering of Hi-C contact maps","text":"Contacts maps can also stored objects class Matrix::dsCMatrix, plain text files. types input also accepted first argument hicClust.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Clustering of Hi-C contact maps","text":"[1] Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N. (2019). Adjacency-constrained hierarchical clustering band similarity matrix application genomics. Algorithms Molecular Biology, 14, 22. [2] Dixon J.R., et al (2012). Topological domains mammalian genomes identified analysis chromatin interactions. Nature, 485(7398), 376. [3] Randriamihamison N., Vialaneix N., Neuvial P. (2021). Applicability interpretability Ward’s hierarchical agglomerative clustering without contiguity constraints. Journal Classification, 38, 363–389. [4] Servant N., et al (2012). HiTC: Exploration High-Throughput ‘C’ experiments. Bioinformatics, 28(21), 2843-2844.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/hicClust.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Clustering of Hi-C contact maps","text":"","code":"sessionInfo() ## R version 4.3.2 (2023-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ## [1] adjclust_0.6.9       HiTC_1.46.0          GenomicRanges_1.54.1 ## [4] GenomeInfoDb_1.38.5  IRanges_2.36.0       S4Vectors_0.40.2     ## [7] BiocGenerics_0.48.1  ##  ## loaded via a namespace (and not attached): ##  [1] SummarizedExperiment_1.32.0 capushe_1.1.2               ##  [3] gtable_0.3.4                rjson_0.2.21                ##  [5] xfun_0.41                   bslib_0.6.1                 ##  [7] ggplot2_3.4.4               Biobase_2.62.0              ##  [9] lattice_0.21-9              vctrs_0.6.5                 ## [11] tools_4.3.2                 bitops_1.0-7                ## [13] parallel_4.3.2              fansi_1.0.6                 ## [15] tibble_3.2.1                highr_0.10                  ## [17] pkgconfig_2.0.3             Matrix_1.6-1.1              ## [19] RColorBrewer_1.1-3          sparseMatrixStats_1.14.0    ## [21] desc_1.4.3                  lifecycle_1.0.4             ## [23] GenomeInfoDbData_1.2.11     compiler_4.3.2              ## [25] stringr_1.5.1               Rsamtools_2.18.0            ## [27] textshaping_0.3.7           Biostrings_2.70.2           ## [29] munsell_0.5.0               codetools_0.2-19            ## [31] htmltools_0.5.7             sass_0.4.8                  ## [33] RCurl_1.98-1.14             yaml_2.3.8                  ## [35] pillar_1.9.0                pkgdown_2.0.7               ## [37] crayon_1.5.2                jquerylib_0.1.4             ## [39] MASS_7.3-60                 BiocParallel_1.36.0         ## [41] cachem_1.0.8                DelayedArray_0.28.0         ## [43] viridis_0.6.5               abind_1.4-5                 ## [45] digest_0.6.34               stringi_1.8.3               ## [47] purrr_1.0.2                 restfulr_0.0.15             ## [49] fastmap_1.1.1               grid_4.3.2                  ## [51] colorspace_2.1-0            cli_3.6.2                   ## [53] SparseArray_1.2.3           magrittr_2.0.3              ## [55] S4Arrays_1.2.0              utf8_1.2.4                  ## [57] XML_3.99-0.16.1             scales_1.3.0                ## [59] rmarkdown_2.25              XVector_0.42.0              ## [61] matrixStats_1.2.0           gridExtra_2.3               ## [63] ragg_1.2.7                  memoise_2.0.1               ## [65] evaluate_0.23               knitr_1.45                  ## [67] BiocIO_1.12.0               viridisLite_0.4.2           ## [69] rtracklayer_1.62.0          rlang_1.1.3                 ## [71] dendextend_1.17.1           Rcpp_1.0.12                 ## [73] glue_1.7.0                  jsonlite_1.8.8              ## [75] R6_2.5.1                    MatrixGenerics_1.14.0       ## [77] GenomicAlignments_1.38.2    systemfonts_1.0.5           ## [79] fs_1.6.3                    zlibbioc_1.48.0"},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"basic-implementation-of-chac-in-adjclust","dir":"Articles","previous_headings":"Notes on relations between similarity and dissimilarity implementation","what":"Basic implementation of CHAC in adjclust","title":"Implementation notes for the `adjclust` package","text":"basic implementation adjclust takes, input, kernel \\(k\\) supposed symmetric positive (kernel sense). data format, constrained clustering can performed , addition, kernel \\(k\\) supposed null entries outside diagonal size h. implementation one described [1].","code":"fit <- adjClust(k, type = \"similarity\") fit <- adjClust(k, type = \"similarity\", h = h)"},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"non-positive-but-normalized-similarities","dir":"Articles","previous_headings":"Notes on relations between similarity and dissimilarity implementation > More advanced used for kernel or similarity matrices","what":"Non positive but normalized similarities","title":"Implementation notes for the `adjclust` package","text":"section, available data set matrix \\(s\\) can either positive entries (case called similarity) positive non-positive entries. , addition, matrix \\(s\\) normalized, .e., \\(s(,) + s(j,j) - 2s(,j) \\geq 0\\) \\(,j=1,\\ldots,n\\) algorithm implemented adjclust can applied directly, similarly standard kernel (section 1). section explains case. interpretation similar kernel case, assumption small similarity values similarity values strongly negative less expected clustered together large similarity values. application method justified fact , given matrix \\(s\\) described , can find \\(\\lambda > 0\\) matrix \\(k_\\lambda\\) defined \\[   \\forall\\,1,\\ldots,n,\\qquad k_\\lambda(,j) = s(,j) + \\lambda   \\mathbb{1}_{\\{=j\\}} \\] kernel (.e., matrix \\(k = s + \\lambda \\) positive definite; indeed, case \\(\\lambda\\) larger opposite smallest negative eigenvalue \\(s\\). [3] shows HAC obtained distance induced kernel \\(k_\\lambda\\) feature space HAC obtained ad hoc dissimilarity defined \\[   \\forall\\, ,j=1,\\ldots,n,\\qquad d(,j) = \\sqrt{s(,) + s(j,j) - 2s(,j)} \\] identical, except merging levels shifted \\(\\lambda\\). conclusion, address case, command lines used ones described section 1.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"non-normalized-similarities","dir":"Articles","previous_headings":"Notes on relations between similarity and dissimilarity implementation > More advanced used for kernel or similarity matrices","what":"Non normalized similarities","title":"Implementation notes for the `adjclust` package","text":"Suppose now data set described matrix \\(s\\) previous section except similarity matrix normalized, meaning , least one pair \\((,j)\\), \\[   2s(,j) > s(,) + s(j,j). \\] package performs following pre-transformation: matrix \\(s^{*}\\) defined \\[   \\forall\\,,j=1,\\ldots,n,\\qquad s^{*}(,j) = s(,j) + \\lambda   \\mathbb{1}_{\\{=j\\}} \\] \\(\\lambda\\) large enough ensure \\(s^{*}\\) becomes normalized. package, \\(\\lambda\\) chosen \\[   \\lambda := \\epsilon + \\max_{,j} \\left(2s(,j) - s(,) - s(j,j)\\right)_+ \\] small \\(\\epsilon > 0\\). case justified property described Section 2.1 (Non-positive normalized similarities). underlying idea , shifting diagonal entries similarity matrix change HAC result thus can shifted induce proper ad-hoc dissimilarity matrix. transformation affects heights ensure positive two command lines described first section note still valid.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"case-of-dissimilarity-data","dir":"Articles","previous_headings":"Notes on relations between similarity and dissimilarity implementation > More advanced used for kernel or similarity matrices","what":"Case of dissimilarity data","title":"Implementation notes for the `adjclust` package","text":"original implementation (unconstrained) HAC stats::hclust takes input dissimilarity matrix. However, implementation adjclust based kernel/similarity approach. describe section dissimilarity case handled. Suppose given dissimilarity \\(d\\) satisfies: \\(d\\) non negative entries: \\(d(,j) \\geq 0\\) \\(=1,\\ldots,n\\); \\(d\\) symmetric: \\(d(,j) = d(j,)\\) \\(,j=1,\\ldots,n\\); \\(d\\) null diagonal: \\(d(,) = 0\\) \\(=1,\\ldots,n\\). sequence positive numbers \\((a_i)_{=1,\\ldots,n}\\) provide similarity \\(s\\) \\(d\\) ad-hoc dissimilarity setting: \\[   \\left\\{ \\begin{array}{l}     s(,) = a_i\\\\     s(,j) = \\frac{1}{2} (a_i + a_j - d^2(,j))   \\end{array} \\right. . \\] definition, \\(s\\) normalized choice \\((a_i)_{=1,\\ldots,n}\\) yields clustering (since correspond ad-hoc dissimilarity). arbitrary choice \\(a_i = 1\\) \\(=1,\\ldots,n\\) thus made. basic sparse implementations available , respectively, ","code":"fit <- adjClust(d, type = \"dissimilarity\") fit <- adjClust(d, type = \"dissimilarity\", h = h)"},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"options-for-displaying-the-dendrogram","dir":"Articles","previous_headings":"","what":"Options for displaying the dendrogram","title":"Implementation notes for the `adjclust` package","text":"section, suppose given Euclidean distance \\(d\\) objects (even though results described section specific case, described easily using framework). Ward’s criterion, implemented adjclust aims minimizing Error Sum Squares (ESS) equal : \\[   \\mbox{ESS}(\\mathcal{C}) = \\sum_{C \\\\mathcal{C}} \\sum_{\\C} d^2(, g_C) \\] \\(\\mathcal{C}\\) clustering \\(g_C = \\frac{1}{\\mu_C} \\sum_{\\C} \\) center gravity cluster \\(C\\) \\(\\mu_C\\) elements [6]. sequel, denote: within-cluster dispersion , given cluster \\(C\\), equal \\[ (C) = \\sum_{\\C} d^2(, g_C). \\] can prove \\((C) = \\frac{1}{2\\mu_C} \\sum_{,j \\C} d^2(,j)\\) (see [4] instance); average within-cluster dispersion equal \\(\\frac{(C)}{\\mu_C}\\) corresponds cluster variance. Usually, results standard HAC displayed form dendrogram heights different merges correspond linkage criterion \\[   \\delta(,B) = (\\cup B) - () - (B) \\] merge. criterion corresponds increase total dispersion (ESS) occurs merging two clusters \\(\\) \\(B\\). However, constrained HAC, guaranty criterion non decreasing (see [2] instance) thus, dendrogram build using method can contain reversals branches. default option plot.chac (corresponds mode = \"standard\"). provide dendrograms easier interpret, alternative options implemented package: first one simple correction standard method, three others suggested [3]. sequel, denote \\((m_t)_{t=1,\\ldots,n-1}\\) series linkage criterion values obtained clustering.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"mode-corrected","dir":"Articles","previous_headings":"Options for displaying the dendrogram","what":"mode = \"corrected\"","title":"Implementation notes for the `adjclust` package","text":"option simply corrects heights adding minimal value making non decreasing. precisely, given step \\(t \\\\{2,\\ldots,n-1\\}\\) clustering, \\(m_t < m_{t-1}\\) , define corrected weights : \\[   \\tilde{m}_{t'} = \\left\\{ \\begin{array}{ll}     m_{t'} & \\textrm{} t' < t\\\\     m_{t'} + (m_{t-1} - m_t) & \\textrm{otherwise}   \\end{array} \\right.. \\] correction iteratively performed decreasing merges, ensuring visually increasing dendrogram.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"mode-total-disp","dir":"Articles","previous_headings":"Options for displaying the dendrogram","what":"mode = \"total-disp\"","title":"Implementation notes for the `adjclust` package","text":"option represents dendrogram using total dispersion (objective function) every level clustering. can easily proved total dispersion equal ESS\\(_t = \\sum_{t' \\leq t} m_{t'}\\) quantity always non decreasing. quantity recommended [2] display dendrogram.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"mode-within-disp","dir":"Articles","previous_headings":"Options for displaying the dendrogram","what":"mode = \"within-disp\"","title":"Implementation notes for the `adjclust` package","text":"option represents cluster specific criterion using within cluster dispersion two clusters merged every given step algorithm. can proved quantity also non decreasing, depends strongly cluster size, leading flattened dendrogram cases.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"mode-average-disp","dir":"Articles","previous_headings":"Options for displaying the dendrogram","what":"mode = \"average-disp\"","title":"Implementation notes for the `adjclust` package","text":"last option addresses problem dependency cluster sizes posed previous method (\"within-disp\") using average within-cluster dispersion two clusters merged every given step algorithm. criterion also cluster specific one guaranty absence reversals heights.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"relations-with-hclust-and-rioja","dir":"Articles","previous_headings":"","what":"Relations with ‘hclust’ and ‘rioja’","title":"Implementation notes for the `adjclust` package","text":"documented [4], call hclust(..., method = \"ward.D\") implicitly assumes ... squared distance matrix. explained , make assumption hclust(d^2, method = \"ward.D\") adjClust(d, method = \"dissimilarity\") give identical results ordering (unconstrained) clustering compatible natural ordering objects used constraint. addition, since hclust(..., method = \"ward.D2\") takes linkage \\(\\sqrt{m_t}\\), hclust(d, method = \"ward.D2\") adjClust(d, method = \"dissimilarity\") give identical results merges slot height first square root slot height second, ordering (unconstrained) clustering compatible natural ordering objects used constraint. Finally, rioja uses ESS\\(_t\\) display heights dendrogram (, documented , quantity non decreasing, Euclidean case, even constrained clusterings). Hence, rioja(d, method = \"coniss\") adjClust(d, method = \"dissimilarity\") give identical results merges slot height first cumulative sum slot height second.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/notesCHAC.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Implementation notes for the `adjclust` package","text":"[1] Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N. (2019). Adjacency-constrained hierarchical clustering band similarity matrix application genomics. Algorithms Molecular Biology, 14, 22. [2] Grimm, E.C. (1987) CONISS: fortran 77 program stratigraphically constrained cluster analysis method incremental sum squares. Computers & Geosciences, 13(1), 13-35. [3] Miyamoto S., Abe R., Endo Y., Takeshita J. (2015) Ward method hierarchical clustering non-Euclidean similarity measures. : Proceedings VIIth International Conference Soft Computing Pattern Recognition (SoCPaR 2015). [4] Murtagh, F. Legendre, P. (2014) Ward’s hierarchical agglomerative clustering method: algorithms implement Ward’s criterion? Journal Classification, 31, 274-295. [5] Randriamihamison N., Vialaneix N., & Neuvial P. (2020). Applicability interpretability Ward’s hierarchical agglomerative clustering without contiguity constraints. Journal Classification 38, 1-27. [6] Ward, J.H. (1963) Hierarchical grouping optimize objective function. Journal American Statistical Association, 58(301), 236-244.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"vignette demonstrate use snpClust function adjclust package. snpClust performs adjacency-constrained hierarchical clustering single nucleotide polymorphisms (SNPs), similarity SNPs defined linkage disequilibrium (LD). function implements algorithm described [1]. extension algorithm described [3,4]. Denoting \\(p\\) number SNPs cluster assuming similarity SNPs whose indices distant \\(h\\), time complexity \\(O(p (\\log(p) + h))\\), space complexity \\(O(hp)\\).","code":"library(\"adjclust\")"},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"loading-and-displaying-genotype-data","dir":"Articles","previous_headings":"","what":"Loading and displaying genotype data","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"beginning vignette closely follows “LD vignette” SnpStats package [2]. First, load genotype data. focus ceph.1mb data. data drawn International HapMap Project concern 602 SNPs1 1Mb region chromosome 22 sample 90 Europeans. can compute display LD SNPs.","code":"data(\"ld.example\", package = \"snpStats\") geno <- ceph.1mb[, -316]  ## drop one SNP leading to one missing LD value p <- ncol(geno) nSamples <- nrow(geno) geno ## A SnpMatrix with  90 rows and  602 columns ## Row names:  NA06985 ... NA12892  ## Col names:  rs5993821 ... rs5747302 ld.ceph <- snpStats::ld(geno, stats = \"R.squared\", depth = p-1) image(ld.ceph, lwd = 0)"},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"adjacency-constrained-hierarchical-agglomerative-clustering","dir":"Articles","previous_headings":"","what":"Adjacency-constrained Hierarchical Agglomerative Clustering","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"snpClust function can handle genotype data input: Note due numerical errors LD estimation, estimated LD values may slightly larger 1. values rounded 1 internally. figure suggests LD signal concentrated close diagonal. can focus diagonal band bandwidth parameter h:","code":"fit <- snpClust(geno, stats = \"R.squared\") ## Warning in run.snpClust(x, h = h, stats = stats): Forcing the LD similarity to ## be smaller than or equal to 1 ## Note: 135 merges with non increasing heights. fitH <- snpClust(geno, h = 100, stats = \"R.squared\") ## Warning in run.snpClust(x, h = h, stats = stats): Forcing the LD similarity to ## be smaller than or equal to 1 ## Note: 133 merges with non increasing heights. fitH ##  ## Call: ## snpClust(geno, h = 100, stats = \"R.squared\") ##  ## Cluster method   : snpClust  ## Number of objects: 602"},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"output","dir":"Articles","previous_headings":"","what":"Output","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"output snpClust class chac. particular, can plotted dendrogram silently relying function plot.dendrogram:  Moreover, output contains element named merge describes successive merges clustering, element gains gives improvement criterion optimized clustering successive merge.","code":"plot(fitH, type = \"rectangle\", leaflab = \"perpendicular\") ## Warning:  ## Detected reversals in dendrogram: mode = 'corrected', 'within-disp' or 'total-disp' might be more relevant. head(cbind(fitH$merge, fitH$gains)) ##      [,1] [,2] ## [1,]   -1   -2 ## [2,] -255 -256 ## [3,] -488 -489 ## [4,] -487    3 ## [5,] -486    4 ## [6,] -234 -235"},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"other-types-of-input","dir":"Articles","previous_headings":"","what":"Other types of input","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"section show snpClust function can also applied directly LD values.  Note forced snpStats::ld function return symmetric matrix. can apply snpClust directly LD matrix (class Matrix::dsCMatrix): snpClust also handles inputs class base::matrix:","code":"h <- 100 ld.ceph <- snpStats::ld(geno, stats = \"R.squared\", depth = h, symmetric = TRUE) image(ld.ceph, lwd = 0) fitL <- snpClust(ld.ceph, h) ## Note: forcing the diagonal of the LD similarity matrix to be 1 ## Warning in run.snpClust(x, h = h, stats = stats): Forcing the LD similarity to ## be smaller than or equal to 1 ## Note: 133 merges with non increasing heights. gmat <- as(geno, \"matrix\") fitM <- snpClust(geno, h, stats = \"R.squared\") ## Note: 133 merges with non increasing heights."},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"[1] Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N. (2019). Adjacency-constrained hierarchical clustering band similarity matrix application genomics. Algorithms Molecular Biology, 14, 22. [2] Clayton D. (2015). snpStats: SnpMatrix XSnpMatrix classes methods. R package version 1.20.0 [3] Dehman ., Ambroise C., Neuvial P. (2015). Performance blockwise approach variable selection using linkage disequilibrium information. BMC Bioinformatics, 16, 148. [4] Randriamihamison N., Vialaneix N., Neuvial P. (2021). Applicability interpretability Ward’s hierarchical agglomerative clustering without contiguity constraints. Journal Classification, 38, 363–389.","code":""},{"path":"https://pneuvial.github.io/adjclust/articles/snpClust.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Inferring Linkage Disequilibrium blocks from genotypes","text":"","code":"sessionInfo() ## R version 4.3.2 (2023-10-31) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 22.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] adjclust_0.6.9  snpStats_1.52.0 Matrix_1.6-1.1  survival_3.5-7  ##  ## loaded via a namespace (and not attached): ##  [1] viridis_0.6.5            sass_0.4.8               utf8_1.2.4               ##  [4] stringi_1.8.3            lattice_0.21-9           digest_0.6.34            ##  [7] magrittr_2.0.3           sparseMatrixStats_1.14.0 evaluate_0.23            ## [10] grid_4.3.2               fastmap_1.1.1            jsonlite_1.8.8           ## [13] gridExtra_2.3            purrr_1.0.2              fansi_1.0.6              ## [16] capushe_1.1.2            viridisLite_0.4.2        scales_1.3.0             ## [19] textshaping_0.3.7        jquerylib_0.1.4          cli_3.6.2                ## [22] rlang_1.1.3              munsell_0.5.0            splines_4.3.2            ## [25] cachem_1.0.8             yaml_2.3.8               tools_4.3.2              ## [28] memoise_2.0.1            colorspace_2.1-0         ggplot2_3.4.4            ## [31] BiocGenerics_0.48.1      vctrs_0.6.5              R6_2.5.1                 ## [34] matrixStats_1.2.0        lifecycle_1.0.4          zlibbioc_1.48.0          ## [37] stringr_1.5.1            fs_1.6.3                 MASS_7.3-60              ## [40] ragg_1.2.7               pkgconfig_2.0.3          desc_1.4.3               ## [43] dendextend_1.17.1        pkgdown_2.0.7            bslib_0.6.1              ## [46] pillar_1.9.0             gtable_0.3.4             glue_1.7.0               ## [49] Rcpp_1.0.12              systemfonts_1.0.5        highr_0.10               ## [52] xfun_0.41                tibble_3.2.1             MatrixGenerics_1.14.0    ## [55] knitr_1.45               htmltools_0.5.7          rmarkdown_2.25           ## [58] compiler_4.3.2"},{"path":"https://pneuvial.github.io/adjclust/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Christophe Ambroise. Author. Shubham Chaturvedi. Author. Alia Dehman. Author. Pierre Neuvial. Author, maintainer. Guillem Rigaill. Author. Nathalie Vialaneix. Author. Gabriel Hoffman. Author.","code":""},{"path":"https://pneuvial.github.io/adjclust/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Christophe Ambroise, Alia Dehman, Pierre Neuvial, Guillem Rigaill, Nathalie Vialaneix (2019) Adjacency-constrained hierarchical clustering band similarity matrix application genomics. Algorithms Molecular Biology, 14(22), 363–389. Randriamihamison N, Vialaneix N, Neuvial P (2020). “Applicability interpretability Ward’s hierarchical agglomerative clustering without contiguity constraints.” Journal Classification, 38, 363–389. doi:10.1007/s00357-020-09377-y.","code":"@Article{,   author = {Christophe Ambroise and Alia Dehman and Pierre Neuvial and Guillem Rigaill and Nathalie Vialaneix},   title = {Adjacency-constrained hierarchical clustering of a band similarity matrix with application to genomics},   journal = {Algorithms for Molecular Biology},   year = {2019},   volume = {14},   issue = {22},   pages = {363–389},   doi = {10.1186/s13015-019-0157-4}, } @Article{,   title = {Applicability and interpretability of Ward’s hierarchical agglomerative clustering with or without contiguity constraints},   author = {Nathanael Randriamihamison and Nathalie Vialaneix and Pierre Neuvial},   journal = {Journal of Classification},   year = {2020},   volume = {38},   issue = {2},   pages = {363–389},   doi = {10.1007/s00357-020-09377-y}, }"},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"adjclust-adjacency-constrained-clustering","dir":"","previous_headings":"","what":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"adjclust package provides methods perform adjacency-constrained hierarchical agglomerative clustering. Adjacency-constrained hierarchical agglomerative clustering hierarchical agglomerative clustering (HAC) observation associated position, clustering constrained adjacent clusters merged. useful bioinformatics (e.g. Genome Wide Association Studies Hi-C data analysis). adjclust provides three user level functions: adjClust, snpClust hicClust, briefly explained .","code":""},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"can install adjclust github :","code":"# install.packages(\"devtools\") devtools::install_github(\"pneuvial/adjclust\")"},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"adjclust","dir":"","previous_headings":"","what":"adjClust","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"adjClust performs adjacency-constrained HAC standard sparse, similarity dissimilarity matrices dist objects. Matrix::dgCMatrix Matrix::dsCMatrix supported sparse matrix classes. Let’s look basic example  result class chac. can plotted dendrogram (shown ). Successive merge heights clustering can obtained fit$merge fit$height respectively.","code":"library(\"adjclust\")  sim <- matrix(c(1.0, 0.5, 0.2, 0.1,                 0.5, 1.0, 0.1, 0.2,                 0.2, 0.1, 1.0, 0.6,                 0.1, 0.2 ,0.6 ,1.0), nrow=4) h <- 3 fit <- adjClust(sim, \"similarity\", h) plot(fit)"},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"snpclust","dir":"","previous_headings":"","what":"snpClust","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"snpClust performs adjacency-constrained HAC specific application Genome Wide Association Studies (GWAS). minimal example given . See GWAS Vignette details.","code":"library(\"snpStats\") #> Loading required package: survival #> Loading required package: Matrix data(\"ld.example\", package = \"snpStats\") geno <- ceph.1mb[, -316]  ## drop one SNP leading to one missing LD value h <- 100 ld.ceph <- ld(geno, stats = \"R.squared\", depth = h) image(ld.ceph, lwd = 0) fit <- snpClust(geno, stats = \"R.squared\", h = h) #> Warning in run.snpClust(x, h = h, stats = stats): Forcing the LD similarity to #> be smaller than or equal to 1 #> Note: 133 merges with non increasing heights. plot(fit) #> Warning:  #> Detected reversals in dendrogram: mode = 'corrected', 'within-disp' or 'total-disp' might be more relevant. sel_clust <- select(fit, \"bs\") plotSim(as.matrix(ld.ceph), clustering = sel_clust, dendro = fit) #> Warning:  #> Detected reversals in dendrogram: mode = 'corrected', 'within-disp' or 'total-disp' might be more relevant. #> Warning: Removed 602 rows containing missing values (`geom_text()`)."},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"hicclust","dir":"","previous_headings":"","what":"hicClust","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"hicClust performs adjacency-constrained HAC specific application Hi-C data analysis. minimal example given . See Hi-C Vignette details.","code":"library(\"HiTC\") load(system.file(\"extdata\", \"hic_imr90_40_XX.rda\", package = \"adjclust\")) binned <- binningC(hic_imr90_40_XX, binsize = 5e5) #> Bin size 'xgi' =500488 [1x500488] #> Bin size 'ygi' =500488 [1x500488] mapC(binned) #> minrange= 104  - maxrange= 36776.8 fitB <- hicClust(binned) #> Note: 5 merges with non increasing heights. plot(fitB) #> Warning:  #> Detected reversals in dendrogram: mode = 'corrected', 'within-disp' or 'total-disp' might be more relevant. plotSim(intdata(binned), dendro = fitB) # default: log scale for colors #> Warning:  #> Detected reversals in dendrogram: mode = 'corrected', 'within-disp' or 'total-disp' might be more relevant. #> Warning: Removed 41 rows containing missing values (`geom_text()`)."},{"path":"https://pneuvial.github.io/adjclust/index.html","id":"credits","dir":"","previous_headings":"","what":"Credits","title":"Adjacency-Constrained Clustering of a Block-Diagonal Similarity Matrix","text":"Version 0.4.0 package completed Shubham Chaturvedi part Google Summer Code 2017 program.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjacency-constrained Clustering — adjClust","title":"Adjacency-constrained Clustering — adjClust","text":"Adjacency-constrained hierarchical agglomerative clustering","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjacency-constrained Clustering — adjClust","text":"","code":"adjClust(   mat,   type = c(\"similarity\", \"dissimilarity\"),   h = ncol(mat) - 1,   strictCheck = TRUE,   nthreads = 1L )"},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjacency-constrained Clustering — adjClust","text":"mat similarity matrix dist object. sparse formats sparseMatrix allowed type Type matrix : similarity dissimilarity. Defaults \"similarity\" h band width. assumed similarity two items 0 items distance band width h. Default value ncol(mat)-1 strictCheck Logical (default TRUE) systematically check default positivity input similarities. Can disabled avoid computationally expensive checks number features large. nthreads Integer (default 1L). Number threads use matrix precomputations.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjacency-constrained Clustering — adjClust","text":"object class chac describes tree   produced clustering process. object list   elements object class hclust (merge,  height, order, labels, call, method,  dist.method), two extra elements: mat : (data clustering performed,      possibly pre-transformations described vignette entitled     \"Notes CHAC implementation adjclust\" . correction : value correction non positive     definite similarity matrices (also described vignette).     correction == 0, means initial data      pre-transformed.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Adjacency-constrained Clustering — adjClust","text":"Adjacency-constrained hierarchical agglomerative clustering (HAC) HAC observation associated position, clustering constrained adjacent clusters merged. methods useful various application fields, including ecology (Quaternary data) bioinformatics (e.g., Genome-Wide Association Studies (GWAS)). function fast implementation method takes advantage sparse similarity matrices (.e., 0 entries outside diagonal band width h). method fully described (Dehman, 2015) based kernel version algorithm. different options implementation available package vignette entitled  \"Notes CHAC implementation adjclust\".","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Adjacency-constrained Clustering — adjClust","text":"performed distance matrix \\(d\\) option  type = \"dissimilarity\", adjclust identical using  option \"ward.D\" \\(d^2\\) function  hclust ordering (unconstrained)  clustering (hclust) compatible natural  ordering objects used constraint. also equivalent (assumption orderings) option \"ward.D2\" performed distance matrix \\(d\\) , except final heights merges  equal square heights obtained \"ward.D2\" hclust. See  vignette implementation  (Murtagh Legendre, 2014) details.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Adjacency-constrained Clustering — adjClust","text":"Murtagh F., Legendre P. (2014). Ward's hierarchical   agglomerative clustering method: algorithms implement Ward's    criterion? Journal Classification, 31, 274-295.    DOI: doi:10.1007/s00357-014-9161-z . Dehman . (2015). Spatial Clustering Linkage   Disequilibrium Blocks Genome-Wide Association Studies, PhD thesis,   Universite Paris Saclay, France. Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N   (2019). Adjacency-constrained hierarchical clustering band similarity    matrix application genomics. Algorithms Molecular   Biology, 14(22).   DOI: doi:10.1007/s11222-018-9806-6 . Randriamihamison N., Vialaneix N., Neuvial P. (2020).   Applicability interpretability Ward's hierarchical agglomerative   clustering without contiguity constraints. Journal    Classification, 38, 1-27.   DOI: doi:10.1007/s00357-020-09377-y .","code":""},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/reference/adjClust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adjacency-constrained Clustering — adjClust","text":"","code":"sim <- matrix(   c(1.0, 0.1, 0.2, 0.3,     0.1, 1.0 ,0.4 ,0.5,     0.2, 0.4, 1.0, 0.6,     0.3, 0.5, 0.6, 1.0),   nrow = 4)  ## similarity, full width fit1 <- adjClust(sim, \"similarity\") plot(fit1)   ## similarity, h < p-1 fit2 <- adjClust(sim, \"similarity\", h = 2) plot(fit2)   ## dissimilarity dist <- as.dist(sqrt(2-(2*sim)))  ## dissimilarity, full width fit3 <- adjClust(dist, \"dissimilarity\") plot(fit3)   ## dissimilarity, h < p-1 fit4 <- adjClust(dist, \"dissimilarity\", h = 2) plot(fit4)"},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":null,"dir":"Reference","previous_headings":"","what":"Class chac — chac","title":"Class chac — chac","text":"S3 class Constrained Hierarchical Agglomerative Clustering results","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Class chac — chac","text":"","code":"# S3 method for chac as.hclust(x, ...)  # S3 method for chac print(x, ...)  # S3 method for chac head(x, ...)  # S3 method for chac summary(object, ...)  # S3 method for chac plot(   x,   y,   ...,   mode = c(\"standard\", \"corrected\", \"total-disp\", \"within-disp\", \"average-disp\"),   nodeLabel = FALSE )  diagnose(x, graph = TRUE, verbose = TRUE)  correct(x)  cutree_chac(tree, k = NULL, h = NULL)"},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Class chac — chac","text":"x, object, tree object class 'chac' ... plot, arguments passed function  plot.dendrogram. Default values type leaflab respectively set \"triangle\" \"none\" y used mode type dendrogram plot (see Details). Default  \"standard\" nodeLabel (logical) whether order merging displayed . nodeLabel=TRUE prints orders fusion corresponding nodes. Default FALSE graph (logical) whether diagnostic plot displayed  . Default TRUE verbose (logical) whether print summary result . Default TRUE k integer scalar vector desired number groups h numeric scalar vector heights tree cut. available heights increasing","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Class chac — chac","text":"function plot.chac displays dendrogram  additionally invisibly returns object class  dendrogram heights specified user option mode. diagnose invisibly exports data frame  numbers decreasing merges described labels clusters merged step previous one, well corresponding merge heights. function correct returns chac objects modified heights increasing. new heights calculated way identical option mode = \"corrected\" function plot.chac (see Details). addition, chac object field method modified adjClust  adjClust-modified. function cutree_chac returns clustering  k groups groups obtained cutting tree height h. heights increasing, cutting tree based corrected heights provided function correct.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Class chac — chac","text":"Methods class 'chac' plot.chac called  mode = \"standard\", standard dendrogram plotted, even though, due contingency constrains, branches reversed (decreasing merges). plot.chac called  mode = \"corrected\", correction applied original heights non decreasing merges). change result  clustering, look dendrogram easier interpretation. modes provided correspond different alternatives described Grimm (1987): mode = \"within-disp\", heights correspond within-cluster dispersion, .e., corresponding cluster, height  $$(C) = \\sum_{\\C} d(,g_C)$$ \\(d\\) dissimilarity  used cluster objects \\(g_C\\) center gravity cluster \\(C\\). case, heights always non decreasing; mode = \"total-disp\", heights correspond total within-cluster dispersion. obtained mode = \"standard\" cumulative sum heights. case, heights always non decreasing; mode = \"average-disp\", heights correspond  within-cluster dispersion divided cluster size. case,  guaranty heights non decreasing. reversals  detected, warning printed advice user change mode representation. Grimm (1987) indicates heights provided  mode = \"within-disp\" highly dependent cluster sizes  advisable representation one provided  mode = \"total-disp\". details provided vignette  \"Notes CHAC implementation adjclust\".","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/chac.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Class chac — chac","text":"Grimm, E.C. (1987) CONISS: fortran 77 program stratigraphically constrained analysis method incremental sum squares. Computer & Geosciences, 13(1), 13-35.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"Adjacency-constrained hierarchical agglomerative clustering Hi-C contact maps","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"","code":"hicClust(x, h = NULL, log = FALSE, ...)"},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"x either: 1. pxp contact sparse dense matrix (classes matrix, Matrix, dscMatrix, dgTMatrix, dgCMatrix, dgeMatrix). entries  number counts physical interactions observed pairs loci.  2. object class HiTC::HTCexp. corresponding Hi-C data stored  Matrix::dsCMatrix object intdata slot. 3. text file path one  line per pair loci interaction observed ( format: locus1<tab>locus2<tab>signal) matrix data frame similar data (3 columns). h band width. provided, h set default value `p-1`. log logical. Whether log-transform count data. Default  FALSE. ... arguments passed read.table  function x text file name. provided, text file  supposed separated tabulations, header.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"object class chac.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"Adjacency-constrained hierarchical agglomerative clustering (HAC) HAC observation associated position, clustering  constrained adjacent clusters merged. Genomic regions (loci) clustered according information provided high-throughput conformation capture data (Hi-C).","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N   (2019). Adjacency-constrained hierarchical clustering band   similarity matrix application genomics, Algorithms Molecular   Biology 14(22)\" Servant N. et al (2012). HiTC : Exploration    High-Throughput 'C' experiments. Bioinformatics.","code":""},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/reference/hicClust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adjacency-constrained Clustering of Hi-C contact maps — hicClust","text":"","code":"# input as HiTC::HTCexp object if (FALSE) { if (require(\"HiTC\", quietly = TRUE)) {   load(system.file(\"extdata\", \"hic_imr90_40_XX.rda\", package = \"adjclust\"))   res1 <- hicClust(hic_imr90_40_XX) } }  # input as Matrix::dsCMatrix contact map if (FALSE) { mat <- HiTC::intdata(hic_imr90_40_XX)  res2 <- hicClust(mat) }  # input as text file res3 <- hicClust(system.file(\"extdata\", \"sample.txt\", package = \"adjclust\")) #> Note: 1 merges with non increasing heights."},{"path":"https://pneuvial.github.io/adjclust/reference/plotSim.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot (dis)similarity matrix — plotSim","title":"Plot (dis)similarity matrix — plotSim","text":"Heatmap (dis)similarity matrix","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/plotSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot (dis)similarity matrix — plotSim","text":"","code":"plotSim(   mat,   type = c(\"similarity\", \"dissimilarity\"),   clustering = NULL,   dendro = NULL,   k = NULL,   log = TRUE,   legendName = \"intensity\",   main = NULL,   priorCount = 0.5,   stats = c(\"R.squared\", \"D.prime\"),   h = NULL,   axis = FALSE,   naxis = min(10, nrow(mat)),   axistext = NULL,   xlab = \"objects\",   cluster_col = \"darkred\",   mode = c(\"standard\", \"corrected\", \"total-disp\", \"within-disp\", \"average-disp\") )"},{"path":"https://pneuvial.github.io/adjclust/reference/plotSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot (dis)similarity matrix — plotSim","text":"mat matrix plot. can class 'matrix',  'dgCMatrix', 'dsCMatrix', 'dist', 'HTCexp', 'snpMatrix'. type input matrix type. Can either \"similarity\"  \"dissimilarity\" (kernels supposed type  \"similarity\"). clustering vector clusters display matrix ( NULL). clustering provided, must numeric vector length identical matrix size clusters identified  consecutive integers 1, 2, 3, ... dendro dendrogram provided hclust object, another type object can converted hclust .hclust. k number clusters display. Used dendro NULL clustering NULL. clustering  deduced dendrogram standard cut. log logical. breaks based log-scaled values matrix entries. Default TRUE. legendName character. Title legend. Default  \"intensity\". main character. Title plot. Default NULL (title). priorCount numeric. Average count added entry matrix avoid taking log zero. Used log == TRUE  default 0.5. stats input SNP correlation type. Used mat type  SnpMatrix. h positive integer. Threshold distance SNP correlation  computation. Used mat type SnpMatrix. axis logical. x-axis displayed plot? Default  FALSE. naxis integer. axis == TRUE, number ticks display x-axis. axistext character vector. axis == TRUE, labels display x-axis (length equal naxis). xlab character. axis == TRUE, x-axis title. cluster_col colour cluster line clustering NULL. mode type dendrogram plot (see plot.chac). Default \"standard\".","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/plotSim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot (dis)similarity matrix — plotSim","text":"function produces heatmap used (dis)similarity matrix  can used diagnostic plot check consistency  obtained clustering original (dis)similarity","code":""},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/reference/plotSim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot (dis)similarity matrix — plotSim","text":"","code":"if (FALSE) { clustering <- rep(1:3, each = 50) dist_data <- as.matrix(dist(iris[, 1:4])) dendro_iris <- adjClust(dist_data, type = \"dissimilarity\") plotSim(dist_data, type = \"dissimilarity\", dendro = dendro_iris, axis = TRUE) plotSim(dist_data, type = \"dissimilarity\", dendro = dendro_iris,         clustering = clustering) plotSim(dist_data, type = \"dissimilarity\", dendro = dendro_iris, axis = TRUE,         k = 3) plotSim(dist_data, type = \"dissimilarity\", legendName = \"IF\", axis = TRUE,          clustering = clustering) p <- plotSim(dist(iris[, 1:4]), type = \"dissimilarity\", log = FALSE,               clustering = clustering, cluster_col = \"blue\") # custom palette p + scale_fill_gradient(low = \"yellow\", high = \"red\") # dsCMatrix m <- Matrix(c(0, 0, 2, 0, 3, 0, 2, 0, 0), ncol = 3) res <- adjClust(m) plotSim(m, axis = TRUE) plotSim(m, dendro = res) # dgCMatrix m <- as(m, \"generalMatrix\") plotSim(m) m <- as.dist(m) if (require(\"HiTC\", quietly = TRUE)) {   load(system.file(\"extdata\", \"hic_imr90_40_XX.rda\", package = \"adjclust\"))   res <- hicClust(hic_imr90_40_XX, log = TRUE)   plotSim(hic_imr90_40_XX, axis = TRUE) } if (requireNamespace(\"snpStats\", quietly = TRUE)) {   data(testdata, package = \"snpStats\")   plotSim(Autosomes[1:200, 1:5], h = 3, stats = \"R.squared\", axis = TRUE,           axistext = c(\"A\", \"B\", \"C\", \"D\", \"E\")) } }"},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":null,"dir":"Reference","previous_headings":"","what":"Clustering selection — select","title":"Clustering selection — select","text":"Clustering selection chac object slope heuristic broken stick heuristic","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clustering selection — select","text":"","code":"select(   x,   type = c(\"capushe\", \"bstick\"),   k.max = NULL,   graph = FALSE,   pct = 0.15 )"},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clustering selection — select","text":"x object class 'chac' type model selection approach slope heuristic  (\"capushe\") broken stick approach (\"bstick\") k.max maximum number clusters can selected. Default  NULL, case set  \\(\\min(\\max(100, \\frac{n}{\\log(n)}), \\frac{n}{2})\\) \\(n\\) number objects clustered capushe \\(n\\) broken stick model graph logical. Whether diagnostic plot capushe selection displayed . Default FALSE pct minimum percentage points plateau selection  capushe selection. See DDSE details","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clustering selection — select","text":"function returns clustering selected slope heuristic, implemented R package capushe.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Clustering selection — select","text":"Baudry J.P., Maugis C., Michel B. (2012). Slope heuristics:  overview implementation. Statistics Computing, 22(2), 355-470. MacArthur, R.H. (1957) relative abundance bird species.  Proceedings National Academy Sciences, 43, 293-295.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/select.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clustering selection — select","text":"","code":"if (FALSE) if (require(\"HiTC\", quietly = TRUE)) {   load(system.file(\"extdata\", \"hic_imr90_40_XX.rda\", package = \"adjclust\"))   res <- hicClust(hic_imr90_40_XX, log = TRUE)   selected.capushe <- select(res)   table(selected.capushe)   selected.bs <- select(res, type = \"bstick\")   table(selected.bs) }  res <- adjClust(dist(iris[, 1:4])) #> Note: input class is 'dist' so 'type' is supposed to be 'dissimilarity' #> Note: 30 merges with non increasing heights. select.clust <- select(res, \"bs\") table(select.clust) #> select.clust #>  1  2  3  #> 50 50 50"},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"Adjacency-constrained hierarchical agglomerative clustering Single Nucleotide Polymorphisms based Linkage Disequilibrium","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"","code":"snpClust(x, h = ncol(x) - 1, stats = c(\"R.squared\", \"D.prime\"))"},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"x either genotype matrix class SnpMatrix/matrix linkage disequilibrium matrix class dgCMatrix. latter case LD values expected [0,1] h band width. provided, h set default value `p-1` `p` number columns x stats character vector specifying linkage disequilibrium measures calculated (using ld function) x genotype matrix. \"R.squared\" \"D.prime\" allowed, see Details.","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"object class chac (LD value missing)","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"Adjacency-constrained hierarchical agglomerative clustering (HAC) HAC observation associated position, clustering constrained adjacent clusters merged. SNPs clustered based similarity measured linkage disequilibrium. special case genotypes given input corresponding LD matrix missing entries, clustering performed. can typically happen insufficient variability sample genotypes. special case, indices SNP pairs yield missing values returned. x class   SnpMatrix matrix,   assumed \\(n \\times p\\) matrix \\(p\\) genotypes   \\(n\\) individuals. input converted LD similarity matrix   using snpStats::ld. x class   dgCMatrix, assumed   (squared) LD matrix. Clustering LD similarity \"R.squared\" \"D.prime\" can   performed providing LD values directly argument x.   values expected [0,1], otherwise truncated [0,1].","code":""},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"Dehman . (2015) Spatial Clustering Linkage   Disequilibrium Blocks Genome-Wide Association Studies, PhD thesis,   Universite Paris Saclay. Dehman, . Ambroise, C. Neuvial, P. (2015). Performance   blockwise approach variable selection using linkage disequilibrium   information. *BMC Bioinformatics* 16:148. Ambroise C., Dehman ., Neuvial P., Rigaill G., Vialaneix N   (2019). Adjacency-constrained hierarchical clustering band   similarity matrix application genomics, Algorithms Molecular   Biology 14(22)\"","code":""},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/reference/snpClust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adjacency-constrained Clustering of Single Nucleotide Polymorphisms — snpClust","text":"","code":"## a very small example if (requireNamespace(\"snpStats\", quietly = TRUE)) {   data(testdata, package = \"snpStats\")    # input as snpStats::SnpMatrix   fit1 <- snpClust(Autosomes[1:200, 1:5], h = 3, stats = \"R.squared\")    # input as base::matrix   fit2 <- snpClust(as.matrix(Autosomes[1:200, 1:5]), h = 3, stats = \"R.squared\")    # input as Matrix::dgCMatrix   ldres <- snpStats::ld(Autosomes[1:200, 1:5], depth = 3, stats = \"R.squared\", symmetric = TRUE)   fit3 <- snpClust(ldres, 3) } #> Note: 1 merges with non increasing heights. #> Note: 1 merges with non increasing heights. #> Note: forcing the diagonal of the LD similarity matrix to be 1 #> Note: 1 merges with non increasing heights."},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-069-2024-02-07","dir":"Changelog","previous_headings":"","what":"Version 0.6.9 [2024-02-07]","title":"Version 0.6.9 [2024-02-07]","text":"CRAN release: 2024-02-08 Properly handled OMP threads C++ code (now default 1 option increase value) Reintroduced tests examples Removed WCSS function exported documented Fixed problem S3class non exported function","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-068-2024-01-10","dir":"Changelog","previous_headings":"","what":"Version 0.6.8 [2024-01-10]","title":"Version 0.6.8 [2024-01-10]","text":"CRAN release: 2024-01-13 Fix CRAN error useNames (deprecated NA) Fix CRAN note itemize (unecessary use itemize) Limited OMP threads 2 examples, vignettes tests Updated citation package","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-067-2023-04-24","dir":"Changelog","previous_headings":"","what":"Version 0.6.7 [2023-04-24]","title":"Version 0.6.7 [2023-04-24]","text":"CRAN release: 2023-04-27 Fix #60 (increase test coverage) Fix #61 (NAMESPACE error ‘SnpClust.matrix’) Fix #45 (update ‘calls’ ’adjclust.*’ methods) Fix #49 (calls ‘library’ tests) Fix #55 (pkgdown action) Fix #40 (moved plotSim ggplot2 version) Fix #30 (improved plotSim, k correct added new arguments) Fix #62 (citation file corrected) Fix #68 (CRAN note)","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-066-2022-09-13","dir":"Changelog","previous_headings":"","what":"Version 0.6.6 [2022-09-13]","title":"Version 0.6.6 [2022-09-13]","text":"CRAN release: 2022-09-14 Minor updates tests comply updates Matrix 1.5.0","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-065-2022-08-18","dir":"Changelog","previous_headings":"","what":"Version 0.6.5 [2022-08-18]","title":"Version 0.6.5 [2022-08-18]","text":"CRAN release: 2022-08-18 Code improvement: replaced class( ) != equivalent expression using inherits( )","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-064-2022-03-30","dir":"Changelog","previous_headings":"","what":"Version 0.6.4 [2022-03-30]","title":"Version 0.6.4 [2022-03-30]","text":"CRAN release: 2022-03-31 Update URL DESCRIPTION Fixed bug tests due recent upgrade Matrix Slightly improved vignettes references ","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-063-2021-07-26","dir":"Changelog","previous_headings":"","what":"Version 0.6.3 [2021-07-26]","title":"Version 0.6.3 [2021-07-26]","text":"CRAN release: 2021-07-26 Fix issues CRAN submission: RcppArmadillo moved LinkingTo, version number Cleanup: move res_adjclust_0.3.0.rda data/ inst/extdata/ Cleanup: remove useless data entries pkgdown index, add missing ones Update docs (using pkgdown) Move site dedicated branch (release pkgdown::deploy_to_branch()) Add inst/CITATION add Randriamihamison et al 2020","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-062-2021-07-22","dir":"Changelog","previous_headings":"","what":"Version 0.6.2 [2021-07-22]","title":"Version 0.6.2 [2021-07-22]","text":"Increase speed code optimization using RcppArmadillo (update Gabriel Hoffman), least linux machines (uses OpenMP) reduces memory usage (update Gabriel Hoffman) option disable expensive checking code (strictCheck = TRUE default, update Gabriel Hoffman)","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-0599-2020-06-08","dir":"Changelog","previous_headings":"","what":"Version 0.5.99 [2020-06-08]","title":"Version 0.5.99 [2020-06-08]","text":"CRAN release: 2020-06-18 Updated citation DESCRIPTION man files (almob paper) added CITATION file. removed exportation S3 classes. changed cutree simple function ‘cutree_chac’ rather method (stats::cutree method).","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-059-2019-12-10","dir":"Changelog","previous_headings":"","what":"Version 0.5.9 [2019-12-10]","title":"Version 0.5.9 [2019-12-10]","text":"CRAN release: 2019-12-10 Clarified types inputs handled adjclust (‘S3 methods’). Shortened examples. Rewrote plotSim avoid CRAN error devel (chose use ‘S3 methods’ now). Fixed similar problem helpers. Clarified code comments. Fixed Issue #35 (probably due change upstream snpStats package). Added test plotSim. Changed test NA snpStats package (probably due change upstream snpStats package) fixed Issue #43. Minor updates tests. package passes R CMD check [0;0;0].","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-057-2018-09-26","dir":"Changelog","previous_headings":"","what":"Version 0.5.7 [2018-09-26]","title":"Version 0.5.7 [2018-09-26]","text":"CRAN release: 2018-09-26 Example Hi-C data now 10x smaller (subset original one). package smaller tests faster. implemented model selection approach based slope heuristic broken stick heuristic select relevant number clusters fixed minor problems method definition class ‘chac’ proposed log-transformation data wrapper ‘hicClust’ implemented heatmap possible highlighting constrained clustering implemented option display number merge dendrogram","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-056-2018-02-08","dir":"Changelog","previous_headings":"","what":"Version 0.5.6 [2018-02-08]","title":"Version 0.5.6 [2018-02-08]","text":"CRAN release: 2018-02-08 changed dependencies Bioconductor packages ‘HiTC’ ‘snpStats’ Suggest conditionally used ","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-055-2018-01-30","dir":"Changelog","previous_headings":"","what":"Version 0.5.5 [2018-01-30]","title":"Version 0.5.5 [2018-01-30]","text":"simplified code (replaced many C functions unique R function using Matrix) adjClust now properly handles similarities diagonal entries different 1 removed arguments used (blMin verbose) simplified Hi-C example","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-054-2018-01-12","dir":"Changelog","previous_headings":"","what":"Version 0.5.4 [2018-01-12]","title":"Version 0.5.4 [2018-01-12]","text":"tests modify modifySparse BUG FIX condnCheck","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-053-2017-12-04","dir":"Changelog","previous_headings":"","what":"Version 0.5.3 [2017-12-04]","title":"Version 0.5.3 [2017-12-04]","text":"‘height’ now defined value linkage criterion (done ‘hclust’), rather total inertia clustering (done ‘rioja’). Added several representations dendrogram corresponding different choices height. Improved documentation vignettes. Removed non-standard fields output ‘adjclust’ (#13). Added tests : equivalence ‘hclust’, comparing sum heights pseudo inertia, plots, non-increasing heights, cutree (#14). Fixed #13 (man). Fixed #15 (cutree decreasing merges). Fixed #3 (Non-positive ‘gains’). Using BiocStyle::html_document2 temporary fix vignette compilation errors.","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-052-2017-10-17","dir":"Changelog","previous_headings":"","what":"Version 0.5.2 [2017-10-17]","title":"Version 0.5.2 [2017-10-17]","text":"CRAN release: 2017-10-18 Added citation Alia Dehman’s PhD thesis DESCRIPTION.","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-051-2017-10-16","dir":"Changelog","previous_headings":"","what":"Version 0.5.1 [2017-10-16]","title":"Version 0.5.1 [2017-10-16]","text":"informative ‘Description’ method DESCRIPTION Updates test scripts pass R CMD check windows platforms Moved README-*.png files man/figures","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-050-2017-10-13","dir":"Changelog","previous_headings":"","what":"Version 0.5.0 [2017-10-13]","title":"Version 0.5.0 [2017-10-13]","text":"Bump version number CRAN submission","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-042-2017-10-05","dir":"Changelog","previous_headings":"","what":"Version 0.4.2 [2017-10-05]","title":"Version 0.4.2 [2017-10-05]","text":"Added ‘chac’ S3 class corresponding ‘plot’ ‘summary’ methods Documentation cleanups Removed objects “R2.100” “Dprime.100” (can obtained imported ‘snpStats’ package) ‘snpClust’: argument ‘stat’ now passed ‘snpStats::ld’ function ‘…’ code cleanups Improved handling default value ‘h’ ‘adjclust’ ‘dist’ objects Renamed ‘prevfit’ explicit ‘res_adjclust_0.3.0’ Dropped ‘simmatrix’ toy data set (now generated fly tests)","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-041-2017-09-15","dir":"Changelog","previous_headings":"","what":"Version 0.4.1 [2017-09-15]","title":"Version 0.4.1 [2017-09-15]","text":"Cleanups Hi-C LD vignettes corresponding tests Dropped outdated BALD test script Added test script NA values LD Renamed Hi-C data sets updated corresponding documentation Added package website generated pkgdown","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-040-2017-08-29","dir":"Changelog","previous_headings":"","what":"Version 0.4.0 [2017-08-29]","title":"Version 0.4.0 [2017-08-29]","text":"Implemented interface handle standard sparse matrices adjClust Implemented interface handle either kernel dissimilarities Implemented wrapper SNP Hi-C data Documented package created vignettes different use cases Added scripts increase package coverage test equivalence rioja small dimensional case Cleaned code improve efficiency removed unnecessary scripts functions","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-030-2017-02-13","dir":"Changelog","previous_headings":"","what":"Version 0.3.0 [2017-02-13]","title":"Version 0.3.0 [2017-02-13]","text":"Removed ‘adjClustBand’: main entry points now ‘HeapHop’ ‘adjClustBand_heap’. Updated test scripts LD vignette accordingly. Added Travis CI AppVeyor support.","code":""},{"path":[]},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-0-2","dir":"Changelog","previous_headings":"","what":"Version 0.2.3 [2017-02-02]","title":"Version 0.2.*","text":"Updated LD vignette adjClustBand, renamed flavor “Koskas” “PseudoMatrix”","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-0-2-1","dir":"Changelog","previous_headings":"","what":"Version 0.2.2 [2016-12-01]","title":"Version 0.2.*","text":"Added dummy R/adjclust.R document() adds ‘importFrom Rcpp evalCpp’ NAMESPACE “Fixed” warning check due .hpp file src (warning exist IMHO)","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-0-2-2","dir":"Changelog","previous_headings":"","what":"Version 0.2.1 [2016-11-09]","title":"Version 0.2.*","text":"Added minimal documentation Replaced “std::cout” “Rcpp::Rcout”, “exit()” “cerr”.","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-0-2-3","dir":"Changelog","previous_headings":"","what":"Version 0.2.0 [2016-06-24]","title":"Version 0.2.*","text":"Incorporated Michel’s implementation (R function ‘HeapHop’) ‘adjClustBand’ now wrapper call either Alia’s Michel’s implementation","code":""},{"path":"https://pneuvial.github.io/adjclust/news/index.html","id":"version-010-2016-06-24","dir":"Changelog","previous_headings":"","what":"Version 0.1.0 [2016-06-24]","title":"Version 0.1.0 [2016-06-24]","text":"Created BALD Added test check reproducing results BALD::cWard","code":""}]
